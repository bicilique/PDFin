<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml"
           fx:controller="com.pdftoolkit.controllers.CompressController"
           styleClass="compress-root">

    <!-- Main Content Container -->
    <BorderPane styleClass="compress-layout">
        
        <!-- Top Bar -->
        <top>
            <HBox styleClass="compress-topbar" alignment="CENTER_LEFT" spacing="16">
                <padding>
                    <Insets top="20" right="32" bottom="20" left="32"/>
                </padding>
                
                <!-- Logo + Title -->
                <Label text="PDFin" styleClass="app-logo"/>
                <Label text="|" styleClass="separator-text"/>
                <Label text="%compress.title" styleClass="page-title-header"/>
                
                <!-- Spacer -->
                <Region HBox.hgrow="ALWAYS"/>
                
                <!-- Language + Theme controls (optional) -->
                <Button fx:id="backButton" text="â†" styleClass="icon-button-minimal" 
                        minWidth="40" minHeight="40"/>
            </HBox>
        </top>
        
        <!-- Main 2-Column Layout -->
        <center>
            <HBox styleClass="compress-main" spacing="24">
                <padding>
                    <Insets top="24" right="32" bottom="32" left="32"/>
                </padding>
                
                <!-- LEFT COLUMN: File Workspace (70%) -->
                <VBox styleClass="file-workspace" HBox.hgrow="ALWAYS" spacing="16">
                    <HBox.margin>
                        <Insets right="12"/>
                    </HBox.margin>
                    
                    <!-- Dropzone (shown when empty) -->
                    <StackPane fx:id="dropZone" styleClass="dropzone-large" 
                               prefHeight="400" VBox.vgrow="ALWAYS">
                        
                        <!-- Empty State -->
                        <VBox alignment="CENTER" spacing="16" fx:id="emptyStateContainer">
                            <Label text="ðŸ“¦" styleClass="dropzone-icon"/>
                            <Label text="%compress.dropHint" styleClass="dropzone-text-primary"/>
                            <Label text="or" styleClass="dropzone-text-secondary"/>
                            <Button fx:id="addFilesButton" text="%compress.selectFiles" 
                                    styleClass="button-large-primary"/>
                        </VBox>
                        
                        <!-- File List (shown when files added) -->
                        <VBox spacing="12" fx:id="fileListContainer" 
                              visible="false" managed="false">
                            
                            <!-- Top Controls Bar -->
                            <HBox alignment="CENTER_LEFT" spacing="12" styleClass="file-controls-bar">
                                <Label text="Selected Files" styleClass="section-subtitle"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button fx:id="addMoreButton" text="+ Add more" 
                                        styleClass="button-secondary-small"/>
                                <Button fx:id="clearButton" text="Clear all" 
                                        styleClass="button-secondary-small"/>
                            </HBox>
                            
                            <!-- File Cards Container -->
                            <ScrollPane fitToWidth="true" styleClass="file-scroll" 
                                       VBox.vgrow="ALWAYS">
                                <ListView fx:id="fileListView" styleClass="file-grid"/>
                            </ScrollPane>
                        </VBox>
                    </StackPane>
                </VBox>
                
                <!-- RIGHT COLUMN: Settings Panel (30%) -->
                <VBox styleClass="settings-panel" spacing="24" prefWidth="360" maxWidth="360">
                    
                    <!-- Compression Level Section -->
                    <VBox spacing="16" styleClass="settings-section">
                        <Label text="%compress.level" styleClass="section-title"/>
                        
                        <!-- Radio Card Options -->
                        <VBox spacing="10" fx:id="compressionOptions">
                            
                            <!-- Extreme Compression Card -->
                            <HBox styleClass="radio-card-container" alignment="CENTER_LEFT" 
                                  spacing="12" fx:id="extremeCard">
                                <RadioButton fx:id="extremeRadio" styleClass="compression-radio"/>
                                <VBox spacing="2" HBox.hgrow="ALWAYS" styleClass="radio-card-content">
                                    <Label text="%compress.level.extreme" styleClass="radio-card-title"/>
                                    <Label text="%compress.level.extreme.desc" styleClass="radio-card-description"/>
                                </VBox>
                            </HBox>
                            
                            <!-- Recommended Compression Card -->
                            <HBox styleClass="radio-card-container" alignment="CENTER_LEFT" 
                                  spacing="12" fx:id="recommendedCard">
                                <RadioButton fx:id="recommendedRadio" selected="true" styleClass="compression-radio"/>
                                <VBox spacing="2" HBox.hgrow="ALWAYS" styleClass="radio-card-content">
                                    <Label text="%compress.level.recommended" styleClass="radio-card-title"/>
                                    <Label text="%compress.level.recommended.desc" styleClass="radio-card-description"/>
                                </VBox>
                            </HBox>
                            
                            <!-- Low Compression Card -->
                            <HBox styleClass="radio-card-container" alignment="CENTER_LEFT" 
                                  spacing="12" fx:id="lowCard">
                                <RadioButton fx:id="lowRadio" styleClass="compression-radio"/>
                                <VBox spacing="2" HBox.hgrow="ALWAYS" styleClass="radio-card-content">
                                    <Label text="%compress.level.low" styleClass="radio-card-title"/>
                                    <Label text="%compress.level.low.desc" styleClass="radio-card-description"/>
                                </VBox>
                            </HBox>
                        </VBox>
                    </VBox>
                    
                    <!-- More Options (Collapsible) -->
                    <VBox spacing="12" styleClass="settings-section">
                        <Button fx:id="moreOptionsToggle" text="More options â–¾" 
                                styleClass="button-text" alignment="CENTER_LEFT" 
                                maxWidth="Infinity"/>
                        
                        <VBox spacing="12" fx:id="moreOptionsPanel" 
                              visible="false" managed="false">
                            
                            <CheckBox fx:id="keepBestQualityCheckbox" 
                                     text="%compress.keepQuality" 
                                     styleClass="checkbox-modern"/>
                            
                            <Separator/>
                            
                            <!-- Output Settings -->
                            <VBox spacing="8">
                                <Label text="Output folder" styleClass="field-label-small"/>
                                <HBox spacing="8">
                                    <TextField fx:id="outputFolderField" HBox.hgrow="ALWAYS" 
                                              editable="false" styleClass="field-modern"/>
                                    <Button fx:id="browseOutputButton" text="ðŸ“" 
                                           styleClass="button-icon"/>
                                </HBox>
                            </VBox>
                            
                            <VBox spacing="8">
                                <Label text="Output filename" styleClass="field-label-small"/>
                                <TextField fx:id="outputFileNameField" 
                                          promptText="compressed.pdf" 
                                          styleClass="field-modern"/>
                            </VBox>
                        </VBox>
                    </VBox>
                    
                    <!-- Spacer to push button to bottom -->
                    <Region VBox.vgrow="ALWAYS"/>
                    
                    <!-- Primary CTA Button -->
                    <Button fx:id="processButton" text="%compress.compressNow" 
                            styleClass="button-cta" maxWidth="Infinity" 
                            minHeight="48" defaultButton="true"/>
                    
                    <!-- Hidden slider for backwards compatibility -->
                    <Slider fx:id="compressionSlider" visible="false" managed="false" 
                           min="1" max="3" value="2"/>
                    <Label fx:id="compressionLevelLabel" visible="false" managed="false"/>
                </VBox>
                
            </HBox>
        </center>
        
    </BorderPane>

    <!-- Progress Overlay: Scrim + Modal Dialog -->
    <StackPane fx:id="progressOverlay" styleClass="progress-scrim" 
               visible="false" managed="false" pickOnBounds="true">
        
        <!-- Scrim Background (blocks interaction) -->
        <Region styleClass="scrim-background"/>
        
        <!-- Modal Dialog -->
        <VBox alignment="CENTER" spacing="24" styleClass="progress-dialog">
            <padding>
                <Insets top="40" right="56" bottom="40" left="56"/>
            </padding>
            
            <!-- Processing State -->
            <VBox fx:id="processingPane" alignment="CENTER" spacing="20">
                <ProgressIndicator styleClass="progress-spinner" prefWidth="64" prefHeight="64"/>
                <Label text="%compress.processing" styleClass="progress-title"/>
                <ProgressBar fx:id="progressBar" prefWidth="380" styleClass="progress-bar-styled"/>
                <Label fx:id="progressLabel" text="%progress.processing" 
                       styleClass="progress-message" wrapText="true" textAlignment="CENTER" 
                       maxWidth="420"/>
                <Button fx:id="cancelButton" text="%compress.cancel" styleClass="button-secondary"/>
            </VBox>
            
            <!-- Completion State -->
            <VBox fx:id="completionPane" alignment="CENTER" spacing="20" 
                  visible="false" managed="false">
                <Label text="âœ“" styleClass="success-icon-xl"/>
                <Label fx:id="completionMessage" text="%compress.success" 
                       styleClass="success-title" wrapText="true" 
                       textAlignment="CENTER" maxWidth="450"/>
                <HBox spacing="12" alignment="CENTER">
                    <Button fx:id="openFolderButton" text="%compress.openFolder" 
                            styleClass="button-secondary"/>
                    <Button fx:id="processAnotherButton" text="%compress.processAnother" 
                            styleClass="button-cta"/>
                </HBox>
            </VBox>
        </VBox>
    </StackPane>

</StackPane>
